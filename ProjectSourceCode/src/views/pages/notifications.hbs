<div class="container">
<h1 class="pt-5">Notifications</h1><br>
<div class="mb-5 shadow p-3 bg-body-tertiary rounded"> 
<table class="table table-light p-1">
            <thead>
                <tr>
                    <th >Sender</th>
                    <th >Message</th>
                    <th >Date</th>
                    <th >Actions</th>
                </tr>
            </thead>
            <tbody>
                {{#each data}}
                <tr>
                    <td>{{sender_username}}</td>
                    <td>{{message}}</td>
                    <td>{{date_sent}}</td>
                    <td>
                        <div id="action-buttons-{{notifications_id}}">
                        <button class="btn btn-success" onclick="handleResponse({{notifications_id}}, 'accept', '{{receiver_username}}', '{{trip_id}}')">Accept</button>
                        <button class="btn btn-danger" onclick="handleResponse({{notifications_id}}, 'decline', '{{receiver_username}}', '{{trip_id}}')">Decline</button>
                        </div>
                       <div id="action-response-{{notifications_id}}" style="display: none;"></div>
                    </td>
                </tr>
                {{/each}}
            </tbody>
        </table>
        </div>

    </div>

        <script>
        function handleResponse(notificationId, action, receiverUsername, tripID) {
            const actionDiv = document.getElementById(`action-buttons-${notificationId}`);
            const responseDiv = document.getElementById(`action-response-${notificationId}`);
            actionDiv.style.display = 'none';

            let url = '';
            let bodyData = {
                notificationId: notificationId,
                receiverUsername: receiverUsername,
                tripID: tripID
            };

            if(action === 'accept'){
                responseDiv.innerHTML = 'Accepted';
                responseDiv.style.color = 'green';
                url = '/notifications/accepted';
            } else if(action === 'decline'){
                responseDiv.innerHTML = 'Declined';
                responseDiv.style.color = 'red';
                url = '/notifications/declined';
            }

            responseDiv.style.display = 'block';

            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(bodyData)
            })
            .then(data => {
                console.log('Success:', data);
            }).catch(error => {
                console.error('Error:', error);
            });
        }
        </script>

        